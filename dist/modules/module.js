"use strict";var source=(()=>{var st=Object.create;var v=Object.defineProperty;var ut=Object.getOwnPropertyDescriptor;var lt=Object.getOwnPropertyNames;var ct=Object.getPrototypeOf,dt=Object.prototype.hasOwnProperty;var u=(t,r)=>()=>(r||t((r={exports:{}}).exports,r),r.exports),pt=(t,r)=>{for(var e in r)v(t,e,{get:r[e],enumerable:!0})},T=(t,r,e,i)=>{if(r&&typeof r=="object"||typeof r=="function")for(let n of lt(r))!dt.call(t,n)&&n!==e&&v(t,n,{get:()=>r[n],enumerable:!(i=ut(r,n))||i.enumerable});return t};var gt=(t,r,e)=>(e=t!=null?st(ct(t)):{},T(r||!t||!t.__esModule?v(e,"default",{value:t,enumerable:!0}):e,t)),ft=t=>T(v({},"__esModule",{value:!0}),t);var F=u(j=>{"use strict";Object.defineProperty(j,"__esModule",{value:!0})});var w=u(I=>{"use strict";var It=I&&I.__createBinding||(Object.create?function(t,r,e,i){i===void 0&&(i=e);var n=Object.getOwnPropertyDescriptor(r,e);(!n||("get"in n?!r.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return r[e]}}),Object.defineProperty(t,i,n)}:function(t,r,e,i){i===void 0&&(i=e),t[i]=r[e]}),Ot=I&&I.__exportStar||function(t,r){for(var e in t)e!=="default"&&!Object.prototype.hasOwnProperty.call(r,e)&&It(r,t,e)};Object.defineProperty(I,"__esModule",{value:!0});Ot(F(),I)});var U=u(S=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0});S.MochiRequestMethod=void 0;var q;(function(t){t.get="get",t.post="post",t.put="put",t.patch="patch"})(q||(S.MochiRequestMethod=q={}))});var $=u(O=>{"use strict";var Et=O&&O.__createBinding||(Object.create?function(t,r,e,i){i===void 0&&(i=e);var n=Object.getOwnPropertyDescriptor(r,e);(!n||("get"in n?!r.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return r[e]}}),Object.defineProperty(t,i,n)}:function(t,r,e,i){i===void 0&&(i=e),t[i]=r[e]}),_t=O&&O.__exportStar||function(t,r){for(var e in t)e!=="default"&&!Object.prototype.hasOwnProperty.call(r,e)&&Et(r,t,e)};Object.defineProperty(O,"__esModule",{value:!0});_t(U(),O)});var H=u(E=>{"use strict";var yt=E&&E.__createBinding||(Object.create?function(t,r,e,i){i===void 0&&(i=e);var n=Object.getOwnPropertyDescriptor(r,e);(!n||("get"in n?!r.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return r[e]}}),Object.defineProperty(t,i,n)}:function(t,r,e,i){i===void 0&&(i=e),t[i]=r[e]}),At=E&&E.__exportStar||function(t,r){for(var e in t)e!=="default"&&!Object.prototype.hasOwnProperty.call(r,e)&&yt(r,t,e)};Object.defineProperty(E,"__esModule",{value:!0});At($(),E)});var W=u(c=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0});c.PlaylistEpisodeServerSkipType=c.PlaylistEpisodeServerSubtitleFormat=c.PlaylistEpisodeServerFormatType=c.PlaylistEpisodeServerQualityType=void 0;var V;(function(t){t[t.auto=0]="auto",t[t.q360p=1]="q360p",t[t.q480p=2]="q480p",t[t.q720p=3]="q720p",t[t.q1080p=4]="q1080p"})(V||(c.PlaylistEpisodeServerQualityType=V={}));var B;(function(t){t[t.hsl=0]="hsl",t[t.dash=1]="dash"})(B||(c.PlaylistEpisodeServerFormatType=B={}));var x;(function(t){t[t.vtt=0]="vtt",t[t.ass=1]="ass",t[t.srt=2]="srt"})(x||(c.PlaylistEpisodeServerSubtitleFormat=x={}));var Y;(function(t){t[t.opening=0]="opening",t[t.ending=1]="ending",t[t.recap=2]="recap"})(Y||(c.PlaylistEpisodeServerSkipType=Y={}))});var K=u(_=>{"use strict";var Pt=_&&_.__createBinding||(Object.create?function(t,r,e,i){i===void 0&&(i=e);var n=Object.getOwnPropertyDescriptor(r,e);(!n||("get"in n?!r.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return r[e]}}),Object.defineProperty(t,i,n)}:function(t,r,e,i){i===void 0&&(i=e),t[i]=r[e]}),mt=_&&_.__exportStar||function(t,r){for(var e in t)e!=="default"&&!Object.prototype.hasOwnProperty.call(r,e)&&Pt(r,t,e)};Object.defineProperty(_,"__esModule",{value:!0});mt(W(),_)});var J=u(y=>{"use strict";var bt=y&&y.__createBinding||(Object.create?function(t,r,e,i){i===void 0&&(i=e);var n=Object.getOwnPropertyDescriptor(r,e);(!n||("get"in n?!r.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return r[e]}}),Object.defineProperty(t,i,n)}:function(t,r,e,i){i===void 0&&(i=e),t[i]=r[e]}),ht=y&&y.__exportStar||function(t,r){for(var e in t)e!=="default"&&!Object.prototype.hasOwnProperty.call(r,e)&&bt(r,t,e)};Object.defineProperty(y,"__esModule",{value:!0});ht(K(),y)});var k=u(l=>{"use strict";Object.defineProperty(l,"__esModule",{value:!0});l.PlaylistPreviewType=l.PlaylistType=l.PlaylistStatus=l.DiscoverListingOrientationType=l.DiscoverListingType=void 0;var Z;(function(t){t[t.default=0]="default",t[t.rank=1]="rank",t[t.featured=2]="featured"})(Z||(l.DiscoverListingType=Z={}));var z;(function(t){t[t.portrait=0]="portrait",t[t.landscape=1]="landscape"})(z||(l.DiscoverListingOrientationType=z={}));var X;(function(t){t[t.unknown=0]="unknown",t[t.upcoming=1]="upcoming",t[t.ongoing=2]="ongoing",t[t.completed=3]="completed",t[t.paused=4]="paused",t[t.cancelled=5]="cancelled"})(X||(l.PlaylistStatus=X={}));var Q;(function(t){t[t.video=0]="video",t[t.image=1]="image",t[t.text=2]="text"})(Q||(l.PlaylistType=Q={}));var G;(function(t){t[t.video=0]="video",t[t.image=1]="image"})(G||(l.PlaylistPreviewType=G={}))});var tt=u(p=>{"use strict";var Nt=p&&p.__createBinding||(Object.create?function(t,r,e,i){i===void 0&&(i=e);var n=Object.getOwnPropertyDescriptor(r,e);(!n||("get"in n?!r.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return r[e]}}),Object.defineProperty(t,i,n)}:function(t,r,e,i){i===void 0&&(i=e),t[i]=r[e]}),vt=p&&p.__exportStar||function(t,r){for(var e in t)e!=="default"&&!Object.prototype.hasOwnProperty.call(r,e)&&Nt(r,t,e)};Object.defineProperty(p,"__esModule",{value:!0});p.SourceModule=void 0;vt(k(),p);var L=class{};p.SourceModule=L});var et=u(D=>{"use strict";Object.defineProperty(D,"__esModule",{value:!0});D.TrackerModule=void 0;var C=class{constructor(){this.metadata={}}};D.TrackerModule=C});var rt=u(g=>{"use strict";var St=g&&g.__createBinding||(Object.create?function(t,r,e,i){i===void 0&&(i=e);var n=Object.getOwnPropertyDescriptor(r,e);(!n||("get"in n?!r.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return r[e]}}),Object.defineProperty(t,i,n)}:function(t,r,e,i){i===void 0&&(i=e),t[i]=r[e]}),it=g&&g.__exportStar||function(t,r){for(var e in t)e!=="default"&&!Object.prototype.hasOwnProperty.call(r,e)&&St(r,t,e)};Object.defineProperty(g,"__esModule",{value:!0});it(tt(),g);it(et(),g)});var nt=u(d=>{"use strict";var Dt=d&&d.__createBinding||(Object.create?function(t,r,e,i){i===void 0&&(i=e);var n=Object.getOwnPropertyDescriptor(r,e);(!n||("get"in n?!r.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return r[e]}}),Object.defineProperty(t,i,n)}:function(t,r,e,i){i===void 0&&(i=e),t[i]=r[e]}),R=d&&d.__exportStar||function(t,r){for(var e in t)e!=="default"&&!Object.prototype.hasOwnProperty.call(r,e)&&Dt(r,t,e)};Object.defineProperty(d,"__esModule",{value:!0});R(w(),d);R(H(),d);R(J(),d);R(rt(),d)});var Rt={};pt(Rt,{default:()=>M});var o=gt(nt());async function at(t){return console.log("Fetching from "+t+"..."),await(await request.get(t)).json()}var h="https://anify.tv",f="https://api.anify.tv",M=class extends o.SourceModule{constructor(){super(...arguments);this.metadata={id:"AnifySource",name:"Anify Source",version:"1.0.0"}}async searchFilters(){return[{id:"genres",displayName:"Genres",multiselect:!0,options:[],required:!1},{id:"tags",displayName:"Tags",multiselect:!0,options:[],required:!1}]}async search(e){let i=await(await request.get(`${f}/search?query=${e.query}&type=anime&page=${e.page??1}`)).json(),n=i.results.map(s=>({id:s.id,url:`${h}/info/${s.id}`,status:s.status==="CANCELLED"?o.PlaylistStatus.cancelled:s.status==="FINISHED"?o.PlaylistStatus.completed:s.status==="HIATUS"?o.PlaylistStatus.paused:s.status==="NOT_YET_RELEASED"?o.PlaylistStatus.upcoming:s.status==="RELEASING"?o.PlaylistStatus.ongoing:o.PlaylistStatus.unknown,type:o.PlaylistType.video,title:s.title.english??s.title.romaji??s.title.native??"Unknown",bannerImage:s.bannerImage??s.coverImage??"",posterImage:s.coverImage??s.bannerImage??""})),A=i.lastPage>Number(e.page??1);return{id:`${f}/search?query=${e.query}&type=anime&page=${e.page??1}`,nextPage:A?`${f}/search?query=${e.query}&type=anime&page=${Number(e.page??1)+1}`:void 0,items:n,previousPage:`${f}/search?query=${e.query}&type=anime&page=${Number(e.page??1)-1}`,title:"Test"}}async discoverListings(e){let i=await(await request.get(`${f}/seasonal?type=anime&fields=[id,description,bannerImage,coverImage,title,genres,format,status,averageRating,episodes,chapters,year,type]`)).json(),n=i.seasonal.map(a=>({id:a.id,url:`${h}/info/${a.id}`,status:a.status==="CANCELLED"?o.PlaylistStatus.cancelled:a.status==="FINISHED"?o.PlaylistStatus.completed:a.status==="HIATUS"?o.PlaylistStatus.paused:a.status==="NOT_YET_RELEASED"?o.PlaylistStatus.upcoming:a.status==="RELEASING"?o.PlaylistStatus.ongoing:o.PlaylistStatus.unknown,type:o.PlaylistType.video,title:a.title.english??a.title.romaji??a.title.native??"Unknown",bannerImage:a.bannerImage??a.coverImage??"",posterImage:a.coverImage??a.bannerImage??""})),A=i.top.map(a=>({id:a.id,url:`${h}/info/${a.id}`,status:a.status==="CANCELLED"?o.PlaylistStatus.cancelled:a.status==="FINISHED"?o.PlaylistStatus.completed:a.status==="HIATUS"?o.PlaylistStatus.paused:a.status==="NOT_YET_RELEASED"?o.PlaylistStatus.upcoming:a.status==="RELEASING"?o.PlaylistStatus.ongoing:o.PlaylistStatus.unknown,type:o.PlaylistType.video,title:a.title.english??a.title.romaji??a.title.native??"Unknown",bannerImage:a.bannerImage??a.coverImage??"",posterImage:a.coverImage??a.bannerImage??""})),s=i.popular.map(a=>({id:a.id,url:`${h}/info/${a.id}`,status:a.status==="CANCELLED"?o.PlaylistStatus.cancelled:a.status==="FINISHED"?o.PlaylistStatus.completed:a.status==="HIATUS"?o.PlaylistStatus.paused:a.status==="NOT_YET_RELEASED"?o.PlaylistStatus.upcoming:a.status==="RELEASING"?o.PlaylistStatus.ongoing:o.PlaylistStatus.unknown,type:o.PlaylistType.video,title:a.title.english??a.title.romaji??a.title.native??"Unknown",bannerImage:a.bannerImage??a.coverImage??"",posterImage:a.coverImage??a.bannerImage??""})),N=i.trending.map(a=>({id:a.id,url:`${h}/info/${a.id}`,status:a.status==="CANCELLED"?o.PlaylistStatus.cancelled:a.status==="FINISHED"?o.PlaylistStatus.completed:a.status==="HIATUS"?o.PlaylistStatus.paused:a.status==="NOT_YET_RELEASED"?o.PlaylistStatus.upcoming:a.status==="RELEASING"?o.PlaylistStatus.ongoing:o.PlaylistStatus.unknown,type:o.PlaylistType.video,title:a.title.english??a.title.romaji??a.title.native??"Unknown",bannerImage:a.bannerImage??a.coverImage??"",posterImage:a.coverImage??a.bannerImage??""}));return[{title:"Trending",type:2,id:"trending",orientation:0,paging:{id:"currently-trending",title:"Trending",previousPage:void 0,nextPage:void 0,items:N}},{title:"Seasonal",type:1,id:"seasonal",orientation:0,paging:{id:"seasonal-anime",title:"Seasonal",previousPage:void 0,nextPage:void 0,items:n}}]}async playlistDetails(e){let i=await(await request.get(`${f}/info/${e}`)).json();return{synopsis:i.description??"No description found.",genres:i.genres,yearReleased:i.year??0,previews:[],altBanners:i.artwork.filter(n=>n.type==="banner"||n.type==="top_banner").map(n=>n.img),altPosters:i.artwork.filter(n=>n.type==="poster").map(n=>n.img),altTitles:Object.values(i.title).filter(Boolean),ratings:i.averageRating??0}}async playlistEpisodeServer(e){let i=await at(`${e.episodeId}`);return{links:i.sources.map(n=>({url:n.url,quality:o.PlaylistEpisodeServerQualityType.auto,format:o.PlaylistEpisodeServerFormatType.dash})),skipTimes:[{startTime:i.intro.start,endTime:i.intro.end,type:o.PlaylistEpisodeServerSkipType.opening},{startTime:i.outro.start,endTime:i.outro.end,type:o.PlaylistEpisodeServerSkipType.ending}],headers:i.headers,subtitles:i.subtitles.map(n=>({url:n.url,name:n.label??n.lang??"Unknown",format:n.url.endsWith("vtt")?o.PlaylistEpisodeServerSubtitleFormat.vtt:n.url.endsWith("ass")?o.PlaylistEpisodeServerSubtitleFormat.ass:n.url.endsWith("srt")?o.PlaylistEpisodeServerSubtitleFormat.srt:o.PlaylistEpisodeServerSubtitleFormat.vtt,default:!!(n.lang==="en-US"||n.lang?.toLowerCase().includes("english")),autoselect:!0}))}}async playlistEpisodeSources(e){return[{id:"servers",servers:[{id:"main",displayName:"Main"}],displayName:"Servers"}]}async playlistEpisodes(e,i){let n=await(await request.get(`${f}/episodes?id=${e}`)).json(),A=[];for(let s of n){let N=[],a=s.episodes,ot=a.map((P,m)=>m%12===0&&a.slice(m,m+12)).filter(Boolean);for(let P of ot){if(!P)continue;let m={id:`${e}-${s.providerId}`,title:`${s.providerId} - ${P[0].number}-${P[P.length-1].number}`,items:[]};for(let b of P)m.items.push({id:`${f}/sources?id=${e}&providerId=${s.providerId}&watchId=${b.id}&subType=sub&episodeNumber=${b.number}`,title:b.number.toString(),number:b.number,description:b.description??void 0,thumbnail:b.img??void 0,tags:[]});N.push(m)}A.push({id:`${e}-${s.providerId}`,title:s.providerId,pagings:N})}return[{id:e,number:1,variants:A}]}};return ft(Rt);})();
